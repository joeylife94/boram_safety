# 📊 Excel 일괄 관리 기능 가이드

보람안전 관리자 시스템의 Excel 일괄 업로드/다운로드 기능 사용 가이드입니다.

## 📥 템플릿 다운로드

1. 관리자 페이지 접속: `http://localhost:3000/admin`
2. **Excel 일괄 관리** 카드 클릭
3. **템플릿 다운로드** 버튼 클릭
4. `product_template_YYYYMMDD.xlsx` 파일 다운로드

## 📝 Excel 파일 작성 방법

### 필수 컬럼
- **카테고리코드**: 반드시 정확한 코드 사용 (아래 목록 참고)
- **제품명**: 제품 이름

### 선택 컬럼
- **모델번호**: 제품 모델 번호
- **가격**: 숫자만 입력 (쉼표 없이, 예: `50000`)
- **설명**: 제품 설명
- **사양**: 제품 사양 정보
- **재고상태**: `in_stock`, `out_of_stock`, `discontinued` 중 하나
- **이미지경로**: 이미지 파일명 (예: `product_001.jpg`)
- **표시순서**: 숫자 (예: `1`, `2`, `3`...)
- **추천제품**: `TRUE` 또는 `FALSE`

### 사용 가능한 카테고리 코드

| 코드 | 카테고리명 |
|------|-----------|
| `safety_helmet` | 안전모 |
| `safety_gloves` | 안전장갑 |
| `safety_boots` | 안전화 |
| `safety_belt` | 안전벨트 |
| `protective_clothing` | 보호복 |
| `respiratory_protection` | 호흡보호구 |
| `hearing_protection` | 청력보호구 |
| `face_protection` | 안면보호구 |
| `leg_protection` | 다리보호구 |
| `musculoskeletal_protection` | 근골격계보호구 |
| `others` | 기타 |

## 📤 제품 데이터 내보내기

### 전체 제품 내보내기
1. Excel 일괄 관리 페이지에서 **전체 제품 내보내기** 버튼 클릭
2. `products_all_YYYYMMDD_HHMMSS.xlsx` 파일 다운로드

### 카테고리별 내보내기
1. **카테고리별 내보내기** 버튼 클릭
2. 카테고리 코드 입력 (예: `safety_helmet`)
3. `products_{category_code}_YYYYMMDD_HHMMSS.xlsx` 파일 다운로드

## 📥 제품 데이터 가져오기

### 추가 모드 (권장)
- 기존 제품 데이터를 **유지**하고 새로운 제품만 추가
- 중복 데이터는 건너뜀
- 안전한 방식

### 교체 모드 (주의!)
- **모든 기존 제품을 삭제**하고 Excel 데이터로 교체
- 데이터 전체를 새로 시작할 때만 사용
- 사용 전 반드시 백업 권장

### 업로드 절차
1. Excel 파일 준비 (템플릿 사용 권장)
2. 업로드 모드 선택 (추가/교체)
3. 파일 선택 및 업로드
4. 결과 확인:
   - 전체 처리 건수
   - 성공 건수
   - 실패 건수
   - 에러 상세 내역

## ⚠️ 주의사항

### 파일 요구사항
- **파일 형식**: `.xlsx` 또는 `.xls`
- **최대 크기**: 10MB
- **첫 번째 행**: 컬럼명(헤더) 필수
- **두 번째 행부터**: 실제 데이터

### 데이터 검증
- 카테고리코드는 미리 등록된 코드만 사용 가능
- 가격은 숫자만 입력 (쉼표 X)
- 재고상태는 정해진 값만 사용
- 이미지 파일은 실제로 존재해야 함

### 에러 처리
- 업로드 시 에러가 발생한 행은 건너뛰고 다음 행 처리
- 에러 목록에서 실패한 행 번호와 에러 메시지 확인
- 에러를 수정한 후 다시 업로드 가능

## 🔄 제품 복사 기능

### 단일 제품 복사
1. 제품 목록에서 복사할 제품 선택
2. **복사** 버튼 클릭
3. 제품명에 "(복사본)" 추가됨
4. 모델번호에 "_copy" 접미사 추가
5. 추천 제품 설정은 해제됨

### API 사용 (개발자용)
```bash
POST /api/admin/products/{product_id}/duplicate
```

## 📊 Excel 처리 흐름

```
1. 템플릿 다운로드
   ↓
2. Excel 파일 작성
   ↓
3. 데이터 검증
   ↓
4. 업로드 (추가/교체 모드 선택)
   ↓
5. 결과 확인
   ↓
6. 필요시 에러 수정 후 재업로드
```

## 🛠️ 트러블슈팅

### 파일 업로드 실패
- 파일 형식 확인 (.xlsx, .xls)
- 파일 크기 확인 (10MB 이하)
- 파일이 열려있지 않은지 확인

### 데이터 임포트 실패
- 카테고리코드 정확성 확인
- 필수 컬럼(카테고리코드, 제품명) 누락 여부
- 데이터 형식 확인 (숫자, TRUE/FALSE 등)
- 에러 메시지 확인 후 해당 행 수정

### 이미지가 표시되지 않음
- 이미지 파일이 `backend/static/images/{category}/` 경로에 있는지 확인
- 이미지경로 컬럼의 파일명이 정확한지 확인
- 파일 확장자 확인 (.jpg, .png 등)

## 📝 예시 데이터

```
카테고리코드    제품명                  모델번호      가격    재고상태    추천제품
safety_helmet   산업용 안전모 A형      SH-2024-001   25000   in_stock    TRUE
safety_gloves   방한 안전장갑 특대     SG-2024-015   12000   in_stock    FALSE
safety_boots    고무 안전화 260mm      SB-2024-032   85000   out_of_stock FALSE
```

## 🚀 대량 데이터 처리 팁

### 효율적인 업로드
1. 제품을 카테고리별로 분류하여 여러 파일로 나누기
2. 파일당 500개 이하로 유지
3. 먼저 소량으로 테스트 후 전체 업로드
4. 업로드 전 데이터 검증 (카테고리코드, 필수값 등)

### 데이터 백업
1. 업로드 전 기존 데이터 내보내기
2. 교체 모드 사용 시 반드시 백업
3. 정기적으로 전체 데이터 내보내기

## 📞 지원

문제가 발생하면 다음 정보를 확인하세요:
- 브라우저 콘솔 에러 메시지
- 업로드 결과의 에러 상세 내역
- 백엔드 로그 (`backend/logs/`)

---

**제작**: 보람안전 관리 시스템
**버전**: 1.0.0
**업데이트**: 2024
